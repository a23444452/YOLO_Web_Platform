# YOLO Web Platform

完整的 YOLO 物體偵測訓練與推論平台，包含前端介面和後端 API。

## 🚀 快速開始

### 使用自動化腳本（推薦）

```bash
# 啟動所有服務
./start.sh

# 查看服務狀態
./status.sh

# 停止所有服務
./stop.sh

# 重啟所有服務
./restart.sh
```

### 手動啟動

#### 後端

```bash
cd backend
source venv/bin/activate
python -m yolo_api.main
```

後端服務運行在 `http://localhost:8000`
API 文檔: `http://localhost:8000/docs`

#### 前端

```bash
cd frontend
pnpm dev
```

前端服務運行在 `http://localhost:5173`

## ✨ 主要功能

### 🎨 標註功能
- 拖放或選擇上傳圖片
- Canvas 繪製邊界框
- 類別管理（新增、編輯、刪除）
- 快捷鍵支援（1-9 選擇類別）
- **🤖 自動標註 (Auto Label)** ⭐ NEW
  - 使用已訓練模型自動標註所有圖片
  - 可調整信心度 (Confidence) 和 IOU 閾值
  - 批量處理，即時顯示進度
  - 自動產生的標註可直接微調與修正
  - 大幅節省人工標註時間
- YOLO 格式資料集導出
- IndexedDB 本地持久化
- Undo/Redo 歷史記錄
- 開啟資料夾功能（自動讀取現有標註）
- 自動保存到原資料夾
- 優化圖片列表顯示（避免裁切）

### 🏋️ 訓練功能
- 多種 YOLO 版本（v5, v8, v11）
- 多種模型大小（n, s, m, l, x）
- 完整的訓練參數配置
  - **基本配置**: 專案名稱、YOLO 版本、模型大小、資料集選擇
  - **訓練參數**: Epochs、Batch Size、Image Size
  - **數據增強**: Mosaic、Mixup、旋轉、翻轉、HSV 調整等
  - **進階設定**:
    - Device (Auto/CPU/GPU 自動選擇)
    - Workers (資料載入執行緒數)
    - Optimizer (Adam/SGD/AdamW)
    - Learning Rate、Momentum、Weight Decay
    - Cosine LR (餘弦退火學習率)
    - Rect (矩形訓練)
    - Cache (圖片快取至記憶體)
- 訓練配置模板保存/載入/刪除
- WebSocket 即時訓練監控
- 自動重連機制
- 心跳維持連接穩定
- 訓練進度即時顯示
- 損失和 mAP 曲線圖
- 一鍵下載訓練模型

### 🎯 推論功能
- **單一圖片推論**
  - 列出所有可用模型（顯示專案名稱和實際模型版本）
  - 自動顯示最新訓練模型
  - 支援上傳本地 .pt/.onnx 模型
  - 自訂信心度和 IOU 閾值
  - 即時視覺化偵測結果
  - Canvas 繪製邊界框
  - 偵測結果清單
  - 推論時間統計
- **批量推論** ⭐ NEW
  - 一次上傳多張圖片進行批量檢測
  - 即時進度追蹤與顯示
  - 成功/失敗狀態視覺化回饋
  - 顯示每張圖片的檢測結果摘要
  - 一鍵下載 CSV 格式結果報告
  - 適合大量圖片的快速測試與驗證

### ⚙️ 設置與文檔
- **設置頁面**: 主題切換、標註偏好、資料管理
- **文檔頁面**: 快速入門指南、快捷鍵參考、常見問題
- **導航優化**: Header 可點擊回首頁、右上角文檔/設置連結

## 🛠️ 技術棧

### 後端
- **框架**: FastAPI 0.115.12
- **AI 引擎**: Ultralytics YOLO
- **資料驗證**: Pydantic v2
- **日誌**: structlog
- **測試**: pytest (91 tests, 77% coverage)
- **程式碼品質**: mypy (strict) + ruff

### 前端
- **框架**: React 19.2.0
- **構建工具**: Vite 7.2.4
- **語言**: TypeScript 5.9.3
- **狀態管理**: Zustand 5.0.10
- **UI 組件**: shadcn/ui + Radix UI
- **樣式**: Tailwind CSS 3.4.1
- **圖表**: Recharts 3.6.0
- **數據持久化**: Dexie.js 4.2.1

## 📚 版本

- **後端**: v0.8.2 - 進階訓練參數支援
- **前端**: v1.7.0 - 批量推論功能

### 最新更新（v1.7.0）
- ✅ **🎯 新增批量推論功能**
  - 分頁式介面設計（單一圖片 / 批量處理）
  - 支援一次上傳多張圖片進行檢測
  - 即時進度條顯示處理狀態
  - 視覺化結果呈現（成功/失敗圖示）
  - 顯示每張圖片的檢測數量與處理時間
  - CSV 結果報告匯出功能
  - 完全前端實作，無需後端修改

### 先前更新（v1.6.4）
- ✅ **調整自動標註預設參數**
  - 信心度 (Confidence) 從 0.25 提升至 0.7
  - IOU 閾值從 0.45 提升至 0.8
  - 更嚴格的過濾條件，減少誤判結果

### 先前更新（v1.6.3）
- ✅ **🐛 修復自動標註功能的關鍵問題**
  - 修復 base64 圖片數據格式錯誤（未移除 data URL 前綴）
  - 修復類別 ID 使用錯誤（陣列索引 vs 實際 ID）
  - 新增完整的除錯日誌系統
    - 模型載入狀態追蹤
    - 每張圖片的推論結果詳情
    - 類別匹配過程追蹤
    - 標註框添加狀態確認
    - 錯誤堆疊完整輸出
  - 現在自動標註功能完全正常運作

### 先前更新（v1.6.1）
- ✅ **修復類別標註數量計算**
  - 修復載入資料夾時類別計數未更新的問題
  - 修復刪除標註框時類別計數未保存至 IndexedDB 的問題
  - 現在類別計數會正確反映所有圖片的標註數量
- ✅ **UI 優化**
  - 增加標註頁面圖片列表寬度（320px → 384px）
  - 改善圖片預覽體驗

### 先前更新（v1.6.0）
- ✅ **🤖 新增自動標註功能**
  - 使用訓練好的模型 (.pt) 自動標註所有圖片
  - 支援信心度 (Confidence) 與 IOU 閾值設定
  - 批量處理，顯示即時進度
  - 智能座標轉換（像素 → YOLO 歸一化格式）
  - 自動產生的標註可在介面上微調與修正
  - 大幅節省人工標註時間

### 先前更新（v1.5.0 / v0.8.2）
- ✅ 新增進階訓練設定
  - Device 自動選擇（Auto/CPU/GPU）
  - Workers 資料載入執行緒數控制
  - Cosine LR 餘弦退火學習率調度
  - Rect 矩形訓練（適合非正方形圖片）
  - Cache 圖片快取至記憶體
- ✅ 優化訓練配置 UI 布局
- ✅ 完善訓練參數說明文字

### 先前更新（v1.4.1 / v0.8.1）
- ✅ 修復推論頁面模型版本顯示錯誤（顯示實際訓練的版本而非硬編碼）
- ✅ 新增設置頁面（主題、標註設定、資料管理）
- ✅ 新增文檔頁面（快速入門、快捷鍵、FAQ）
- ✅ 優化圖片列表顯示（使用 object-contain 避免裁切）
- ✅ Header 導航改進（logo 可點擊、新增文檔/設置連結）
- ✅ 支援區域網路訪問配置

詳細更新日誌：
- 後端: `backend/CHANGELOG.md`
- 前端: `frontend/CHANGELOG.md`

## 📖 使用指南

### 1. 標註資料集

#### 手動標註
1. 進入「標註」頁面
2. 上傳圖片或資料夾
3. 添加類別
4. 繪製邊界框
5. 導出 YOLO 格式 ZIP

#### 自動標註 (推薦) 🤖
1. 進入「標註」頁面
2. 上傳圖片或資料夾
3. 點擊「自動標註」按鈕
4. 選擇已訓練的模型
5. 調整信心度和 IOU 閾值（可選）
6. 點擊「開始自動標註」
7. 等待處理完成
8. 在介面上微調自動產生的標註
9. 導出 YOLO 格式 ZIP

### 2. 訓練模型
1. 進入「訓練」頁面
2. 上傳資料集 ZIP
3. 配置訓練參數
4. 啟動訓練
5. 即時監控進度
6. 下載訓練完成的模型

### 3. 執行推論

#### 單一圖片推論
1. 進入「推論」頁面
2. 選擇「單一圖片」分頁
3. 選擇訓練完成的模型
4. 上傳測試圖片
5. 調整閾值（可選）
6. 執行推論
7. 查看視覺化結果

#### 批量推論 🚀
1. 進入「推論」頁面
2. 切換到「批量處理」分頁
3. 選擇訓練完成的模型
4. 一次選擇多張測試圖片
5. 調整閾值（可選）
6. 執行批量推論
7. 查看進度與結果摘要
8. 下載 CSV 結果報告（可選）

## 🐛 常見問題

### 後端無法啟動
- 確認 Python 虛擬環境已激活
- 檢查依賴：`pip install -r requirements.txt`
- 查看日誌：`tail -f logs/backend.log`

### 前端無法啟動
- 確認 Node.js >= 18
- 重新安裝：`rm -rf node_modules && pnpm install`
- 查看日誌：`tail -f logs/frontend.log`

### WebSocket 連接失敗
- 確認後端正在運行
- 檢查 CORS 配置
- 查看瀏覽器 Console

---

## 🚀 生產部署

想要部署到生產環境？請參考詳細的部署指南：

📖 **[DEPLOYMENT.md](./DEPLOYMENT.md)** - 完整部署指南

包含以下部署方案：
- 🏠 本地/內網部署（適合個人使用）
- 🐳 Docker 容器化部署（適合團隊協作）
- ☁️ 雲端部署（AWS/GCP/Azure）
- 🔀 混合部署（優化成本）

---

**Generated with [Claude Code](https://claude.ai/code) via [Happy](https://happy.engineering)**
