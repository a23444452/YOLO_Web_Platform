# YOLO Web 平台 - 後續開發路線圖

**更新日期**: 2026-01-17
**當前版本**: 1.0.1
**專案狀態**: ✅ 階段一 - 圖像標註模組已完成

---

## 📊 當前完成度

| 模組 | 狀態 | 完成度 | 優先級 |
|-----|------|--------|--------|
| 圖像標註模組 | ✅ 已完成 | 90% | P0 |
| 資料集管理模組 | 🔲 未開始 | 0% | P1 |
| 訓練配置模組 | 🔲 未開始 | 0% | P2 |
| 訓練監控模組 | 🔲 未開始 | 0% | P2 |
| 推論測試模組 | 🔲 未開始 | 0% | P1 |

---

## ✅ 已完成功能

### 圖像標註模組 (Image Labeling) - 90%

#### 核心功能 ✅
- ✅ 圖片上傳 (多選、資料夾、拖放)
- ✅ Canvas 繪製邊界框
- ✅ 框體選擇與編輯
- ✅ 8 點調整大小
- ✅ 框體移動
- ✅ 框體刪除 (Delete 鍵)
- ✅ 類別管理 (新增、編輯、刪除)
- ✅ 快捷鍵支援 (1-9 切換類別, Escape 取消, Delete 刪除)
- ✅ 圖片列表導航
- ✅ 左右箭頭切換圖片
- ✅ 縮放和平移功能
- ✅ YOLO 格式導出 (.zip)

#### 待優化 🔶
- 🔲 Undo/Redo 功能
- 🔲 框體複製/貼上 (Ctrl+C, Ctrl+V)
- 🔲 IndexedDB 持久化存儲
- 🔲 批量編輯框體類別
- 🔲 框體標註品質檢查
- 🔲 匯入現有 YOLO 標註

---

## 🎯 後續開發計劃

### 階段二：資料集管理模組 (優先級: P1)

**預估時間**: 3-4 天
**依賴**: 圖像標註模組

#### 核心功能需求

**1. 資料集創建與管理**
- [ ] 從標註圖片創建資料集
- [ ] 設定訓練/驗證分割比例 (預設 80/20)
- [ ] 自動隨機分配圖片
- [ ] 資料集命名與描述

**2. 資料集預覽與統計**
- [ ] 總圖片數統計
- [ ] 訓練集/驗證集數量
- [ ] 各類別分布圖表 (長條圖)
- [ ] 邊界框數量統計
- [ ] 樣本圖片網格預覽

**3. 資料集操作**
- [ ] 列出所有已創建的資料集
- [ ] 刪除資料集 (含確認)
- [ ] 重新分割比例
- [ ] 資料集複製

**4. 進階導出**
- [ ] Train/Val 分離的目錄結構
  ```
  dataset_name/
  ├── images/
  │   ├── train/
  │   └── val/
  ├── labels/
  │   ├── train/
  │   └── val/
  ├── data.yaml
  └── classes.txt
  ```
- [ ] 支援多種格式 (YOLO, COCO, VOC)

#### 技術要點
- 使用 Zustand store 管理資料集狀態
- 實作隨機分割算法
- 使用 Recharts 繪製統計圖表
- JSZip 生成複雜目錄結構

---

### 階段三：推論測試模組 (優先級: P1)

**預估時間**: 5-6 天
**依賴**: ONNX.js 整合

#### 核心功能需求

**1. 模型管理**
- [ ] 上傳 .onnx 模型檔案
- [ ] 模型列表展示
- [ ] 顯示模型資訊 (輸入尺寸、類別數)
- [ ] 刪除模型
- [ ] 模型驗證 (檢查格式)

**2. 推論執行**
- [ ] 上傳測試圖片
- [ ] 選擇推論模型
- [ ] 調整信心度閾值 (0.01-0.99)
- [ ] 調整 IOU 閾值 (0.1-0.9)
- [ ] 單張圖片推論
- [ ] 批量圖片推論

**3. 結果展示**
- [ ] Canvas 繪製偵測框
- [ ] 顯示類別標籤 + 信心度百分比
- [ ] 結果表格 (類別、信心度、座標)
- [ ] 下載標註結果 (YOLO 格式)
- [ ] 結果統計 (各類別偵測數量)

**4. ONNX.js 整合**
- [ ] 載入 ONNX 模型到瀏覽器
- [ ] WebGL 後端加速
- [ ] 圖片預處理 (resize, normalize)
- [ ] 後處理 (NMS 非極大值抑制)
- [ ] 支援 YOLOv5/v8 輸出格式解析

#### 技術要點
- 使用 onnxruntime-web
- 實作圖像預處理 pipeline
- 實作 NMS (Non-Maximum Suppression)
- WebGL 加速 (如果可用)
- Worker 執行推論避免 UI 阻塞

#### 技術難點
- ONNX 模型相容性測試
- 不同 YOLO 版本的輸出格式差異
- 瀏覽器效能優化
- 記憶體管理 (大圖片處理)

---

### 階段四：訓練配置模組 (優先級: P2)

**預估時間**: 4-5 天
**依賴**: 資料集管理模組

#### 核心功能需求

**1. 基本配置**
- [ ] 專案名稱輸入
- [ ] YOLO 版本選擇 (v5 / v8 / v11)
- [ ] 預訓練權重選擇 (n / s / m / l / x)
- [ ] 資料集選擇下拉選單

**2. 訓練參數**
- [ ] Epochs 滑桿 (10-500, 預設 100)
- [ ] Batch Size 選擇 (2/4/8/16/32)
- [ ] Image Size 選擇 (320/416/640/1280)
- [ ] Device 選擇 (CPU / GPU, 自動偵測)
- [ ] Workers 數量 (1-8)

**3. 數據增強選項**
- [ ] Mosaic 增強 (啟用/停用)
- [ ] Mixup 增強 (啟用/停用)
- [ ] 旋轉角度滑桿 (0-45 度)
- [ ] HSV 調整 (色調、飽和度、亮度)
- [ ] 平移比例 (0-0.5)
- [ ] 縮放比例 (0-1)
- [ ] 翻轉選項 (水平、垂直)

**4. 進階設置**
- [ ] Optimizer 選擇 (Adam / SGD / AdamW)
- [ ] Learning Rate (0.0001 - 0.1)
- [ ] Momentum (0.8 - 0.99)
- [ ] Weight Decay (0 - 0.001)
- [ ] Early Stopping Patience (5-50)

**5. 配置管理**
- [ ] 保存配置為模板
- [ ] 載入配置模板
- [ ] 配置驗證與錯誤提示
- [ ] 生成 data.yaml 預覽
- [ ] 匯出配置為 JSON

**6. 模擬訓練 (階段一)**
- [ ] 顯示訓練配置摘要
- [ ] 模擬訓練進度條
- [ ] 生成假訓練日誌
- [ ] 模擬訓練結果曲線
- [ ] 提示需要後端支援

#### UI 設計
- 使用 Tab 導航 (基本配置、訓練參數、數據增強、進階設置)
- 響應式表單佈局
- 即時參數驗證
- 配置預覽面板

---

### 階段五：訓練監控模組 (優先級: P2)

**預估時間**: 3-4 天
**依賴**: 訓練配置模組

#### 核心功能需求 (模擬版本)

**1. 訓練進度顯示**
- [ ] 當前 Epoch / 總 Epochs
- [ ] 進度條 (百分比)
- [ ] 預估剩餘時間
- [ ] 已用時間統計

**2. 即時指標展示**
- [ ] 訓練損失 (Train Loss)
- [ ] 驗證損失 (Val Loss)
- [ ] mAP50
- [ ] mAP50-95
- [ ] 精確率 (Precision)
- [ ] 召回率 (Recall)

**3. 可視化圖表**
- [ ] 損失曲線 (訓練 vs 驗證)
- [ ] mAP 曲線
- [ ] 學習率曲線
- [ ] 圖表縮放與平移
- [ ] 資料點 Tooltip

**4. 訓練日誌**
- [ ] 滾動日誌視窗
- [ ] 自動捲動到最新
- [ ] 日誌級別過濾 (INFO / WARNING / ERROR)
- [ ] 導出日誌為 .txt

**5. 訓練控制**
- [ ] 停止訓練按鈕
- [ ] 訓練狀態徽章 (運行中、已完成、已停止、錯誤)
- [ ] 暫停/繼續訓練 (階段二)
- [ ] 保存檢查點 (階段二)

#### 技術要點
- 使用 Recharts 繪製動態曲線
- 實作模擬訓練數據生成器
- WebSocket 準備 (用於未來後端整合)
- 使用 setInterval 模擬訓練進度

---

## 🔧 圖像標註模組優化清單

### 1. Undo/Redo 功能 (優先級: P1)

**功能描述**:
- 支援撤銷/重做標註操作
- 快捷鍵: Ctrl+Z / Ctrl+Shift+Z (或 Cmd+Z / Cmd+Shift+Z)
- 記錄歷史操作棧

**技術方案**:
```typescript
interface HistoryEntry {
  action: 'add' | 'update' | 'delete';
  target: 'box' | 'class';
  data: any;
  timestamp: Date;
}

// Zustand store 添加
historyStack: HistoryEntry[];
currentHistoryIndex: number;
undo: () => void;
redo: () => void;
```

**預估時間**: 1 天

---

### 2. 框體複製/貼上 (優先級: P2)

**功能描述**:
- Ctrl+C 複製選中的框體
- Ctrl+V 貼上框體 (位置稍微偏移)
- 支援跨圖片複製貼上

**技術方案**:
```typescript
interface Clipboard {
  type: 'box';
  data: BoundingBox;
}

copiedBox: BoundingBox | null;
copyBox: (boxId: string) => void;
pasteBox: (imageId: string) => void;
```

**預估時間**: 0.5 天

---

### 3. IndexedDB 持久化存儲 (優先級: P0)

**功能描述**:
- 使用 IndexedDB 存儲標註數據
- 頁面重新整理後數據不丟失
- 支援大量圖片存儲

**技術方案**:
- 使用 Dexie.js 操作 IndexedDB
- 自動同步 Zustand state 到 IndexedDB
- 啟動時從 IndexedDB 載入數據

**數據結構**:
```typescript
// Dexie schema
class AnnotationDatabase extends Dexie {
  images: Dexie.Table<ImageAnnotation, string>;
  classes: Dexie.Table<ClassDefinition, number>;

  constructor() {
    super('YOLOAnnotationDB');
    this.version(1).stores({
      images: 'id, filename, createdAt, updatedAt',
      classes: 'id, name',
    });
  }
}
```

**預估時間**: 2 天

---

### 4. 匯入現有 YOLO 標註 (優先級: P2)

**功能描述**:
- 上傳 .zip 檔案 (包含 images/ 和 labels/)
- 自動解析 YOLO 格式標註
- 載入到標註工具中繼續編輯

**技術方案**:
- 使用 JSZip 解壓縮
- 解析 .txt 標註檔案
- 讀取 classes.txt
- 關聯圖片與標註

**預估時間**: 2 天

---

### 5. 批量操作功能 (優先級: P3)

**功能描述**:
- 批量選擇圖片
- 批量刪除圖片
- 批量修改框體類別
- 批量導出選中圖片

**預估時間**: 2 天

---

### 6. 標註品質檢查 (優先級: P3)

**功能描述**:
- 檢查空白標註 (無框體的圖片)
- 檢查框體過小 (面積 < 閾值)
- 檢查框體超出邊界
- 檢查重疊框體
- 生成品質報告

**預估時間**: 2 天

---

## 📱 UI/UX 改進建議

### 1. 響應式設計優化
- [ ] 平板尺寸適配
- [ ] 觸控操作支援
- [ ] 手機版簡化界面

### 2. 鍵盤快捷鍵擴展
- [ ] Ctrl+S: 快速保存
- [ ] Ctrl+E: 導出資料
- [ ] Ctrl+A: 全選圖片
- [ ] Space: 平移模式切換
- [ ] +/-: 縮放

### 3. 主題與外觀
- [ ] 深色模式支援
- [ ] 自訂顏色主題
- [ ] 緊湊/舒適佈局切換

### 4. 使用者體驗
- [ ] 新手引導 (Tour)
- [ ] 快捷鍵說明面板
- [ ] 操作提示 (Tooltips)
- [ ] 進階設定面板

---

## 🚀 效能優化計劃

### 1. 圖片處理優化
- [ ] 圖片壓縮 (上傳時)
- [ ] 縮略圖生成
- [ ] 懶加載實作
- [ ] 虛擬滾動 (圖片列表)

### 2. Canvas 渲染優化
- [ ] 離屏 Canvas 緩存
- [ ] 僅重繪變更區域
- [ ] requestAnimationFrame 優化

### 3. 存儲優化
- [ ] IndexedDB 批量操作
- [ ] 數據壓縮
- [ ] 清理過期數據

### 4. 大型資料集支援
- [ ] 分頁載入
- [ ] 增量渲染
- [ ] 後台 Worker 處理

---

## 🧪 測試計劃

### 1. 功能測試
- [ ] 端到端測試 (E2E with Playwright)
- [ ] 單元測試 (Vitest)
- [ ] 整合測試

### 2. 相容性測試
- [ ] Chrome (最新版 + -1)
- [ ] Firefox (最新版 + -1)
- [ ] Safari (最新版)
- [ ] Edge (最新版)

### 3. 效能測試
- [ ] 1000+ 圖片載入測試
- [ ] 記憶體洩漏檢查
- [ ] Canvas 渲染效能測試

### 4. 使用者測試
- [ ] 易用性測試
- [ ] A/B 測試
- [ ] 使用者回饋收集

---

## 📚 文檔計劃

### 1. 使用者文檔
- [ ] 快速入門指南
- [ ] 詳細功能說明
- [ ] 常見問題 (FAQ)
- [ ] 影片教學

### 2. 開發者文檔
- [ ] 架構設計文檔
- [ ] API 參考文檔
- [ ] 貢獻指南
- [ ] 部署指南

---

## 🎯 短期目標 (1-2 週)

按優先級排序:

1. **IndexedDB 持久化存儲** (P0) - 2 天
   - 解決重新整理丟失數據的問題

2. **Undo/Redo 功能** (P1) - 1 天
   - 提升使用者體驗

3. **推論測試模組** (P1) - 5-6 天
   - 完成完整的工作流程

4. **資料集管理模組** (P1) - 3-4 天
   - 支援訓練資料準備

---

## 🎯 中期目標 (3-4 週)

1. **訓練配置模組** (P2) - 4-5 天
2. **訓練監控模組** (P2) - 3-4 天
3. **匯入現有標註** (P2) - 2 天
4. **框體複製/貼上** (P2) - 0.5 天
5. **UI/UX 優化** - 3-4 天

---

## 🎯 長期目標 (1-2 月)

1. **後端整合** (選做)
   - FastAPI 後端搭建
   - 真實訓練功能
   - 用戶認證系統
   - 雲端存儲

2. **進階功能**
   - 多人協作標註
   - 標註品質評分
   - 自動標註輔助 (使用預訓練模型)
   - 標註審核流程

3. **部署與運維**
   - Docker 容器化
   - CI/CD 流程
   - 監控與日誌
   - 備份策略

---

## 📊 時間估算總結

| 階段 | 模組/功能 | 預估時間 |
|-----|----------|----------|
| 優化 | IndexedDB 持久化 | 2 天 |
| 優化 | Undo/Redo | 1 天 |
| 階段二 | 資料集管理模組 | 3-4 天 |
| 階段三 | 推論測試模組 | 5-6 天 |
| 階段四 | 訓練配置模組 | 4-5 天 |
| 階段五 | 訓練監控模組 | 3-4 天 |
| 優化 | 其他功能優化 | 4-5 天 |
| **總計** | **核心功能完成** | **22-27 天** |

---

## 🤔 技術決策與權衡

### 1. 是否需要後端?

**純前端方案 (當前)**:
- ✅ 優點: 零部署成本、快速開發、隱私保護
- ❌ 缺點: 無法真實訓練、存儲限制、無多人協作

**前後端分離方案 (階段三)**:
- ✅ 優點: 真實訓練、雲端存儲、多人協作
- ❌ 缺點: 部署成本、維護複雜度、需要 GPU 資源

**建議**: 先完成純前端版本,驗證產品需求後再考慮後端整合

### 2. ONNX.js vs TensorFlow.js?

**選擇 ONNX.js**:
- YOLO 官方支援 ONNX 導出
- 更好的 YOLO 模型相容性
- WebGL 加速效能優異

### 3. IndexedDB vs LocalStorage?

**選擇 IndexedDB**:
- 更大的存儲容量 (數百 MB)
- 支援 Blob 存儲 (圖片)
- 更好的查詢效能

---

## 💡 創新功能想法

### 1. AI 輔助標註
- 使用輕量級預訓練模型自動標註
- 使用者僅需審核和修正
- 大幅提升標註效率

### 2. 標註品質評分系統
- 根據框體準確度評分
- 提供改進建議
- 標註員績效追蹤

### 3. 協作標註功能
- 多人同時標註不同圖片
- 標註任務分配
- 進度追蹤儀表板

### 4. 標註遊戲化
- 標註積分系統
- 成就徽章
- 排行榜

---

**下一步建議**:
1. 實作 IndexedDB 持久化存儲 (優先級最高)
2. 開發推論測試模組 (完成完整工作流)
3. 實作 Undo/Redo 功能 (提升 UX)
